{"version":3,"file":"index.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst input = document.getElementById('search-input');\nconst galleryEl = document.getElementById('gallery');\nconst loaderEl = document.getElementById('loader');\nconst loadMoreBtn = document.getElementById('load-more');\n\nlet currentPage = 1;\nlet currentQuery = '';\n\nlet lightbox = new SimpleLightbox('.gallery a', { captionsData: 'alt', captionDelay: 250 });\n\nfunction showLoader() {\n  loaderEl.classList.remove('is-hidden');\n  loaderEl.setAttribute('aria-hidden', 'false');\n}\n\nfunction hideLoader() {\n  loaderEl.classList.add('is-hidden');\n  loaderEl.setAttribute('aria-hidden', 'true');\n}\n\nfunction clearGallery() {\n  galleryEl.innerHTML = '';\n}\n\nfunction createCardMarkup(image) {\n  return `\n    <li class=\"card\">\n      <a class=\"card__link\" href=\"${image.largeImageURL}\">\n        <img class=\"card__thumb\" src=\"${image.webformatURL}\" alt=\"${escapeHtml(image.tags)}\" loading=\"lazy\" />\n      </a>\n      <div class=\"card__stats\">\n        <span title=\"Beƒüeniler\">‚ù§Ô∏è ${image.likes}</span>\n        <span title=\"G√∂sterimler\">üëÅ ${image.views}</span>\n        <span title=\"Yorumlar\">üí¨ ${image.comments}</span>\n        <span title=\"ƒ∞ndirilenler\">‚¨á ${image.downloads}</span>\n      </div>\n    </li>\n  `;\n}\n\nfunction escapeHtml(str) {\n  return String(str).replace(/[&<>\\\"']/g, (s) => ({\n    '&':'&amp;',\n    '<':'&lt;',\n    '>':'&gt;',\n    '\"':'&quot;',\n    \"'\":\"&#39;\"\n  }[s]));\n}\n\nasync function fetchImages(query, page = 1) {\n  const params = {\n    key: '52761827-accd899221d475ff75a0f470c',\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    per_page: 40,\n    page: page,\n  };\n\n  try {\n    const response = await axios.get('https://pixabay.com/api/', { params });\n    return response.data;\n  } catch (error) {\n    throw new Error('An error occurred while fetching the images.');\n  }\n}\n\nconst form = document.getElementById('search-form');\n\nform.addEventListener('submit', async (evt) => {\n  evt.preventDefault();\n  const query = input.value.trim();\n  if (!query) return;\n\n  currentQuery = query;\n  currentPage = 1; // Reset page on new search\n  clearGallery();\n  showLoader();\n  loadMoreBtn.classList.add('is-hidden'); // Hide \"Load more\" on new search\n\n  try {\n    const data = await fetchImages(query, currentPage);\n    const hits = data.hits ?? [];\n\n    if (!Array.isArray(hits) || hits.length === 0) {\n      iziToast.warning({\n        title: 'Uyarƒ±',\n        message: \"Sorry, there are no images matching your search query. Please try again!\",\n        position: 'topRight',\n      });\n      return;\n    }\n\n    const markup = hits.map(createCardMarkup).join('');\n    galleryEl.insertAdjacentHTML('beforeend', markup);\n    lightbox.refresh();\n\n    if (data.totalHits > hits.length) {\n      loadMoreBtn.classList.remove('is-hidden');\n    }\n  } catch (error) {\n    console.error(error);\n    iziToast.error({\n      title: 'Hata',\n      message: 'An error occurred during the request. Check the console.',\n      position: 'topRight',\n    });\n  } finally {\n    hideLoader();\n  }\n});\n\nloadMoreBtn.addEventListener('click', async () => {\n  currentPage += 1;\n  showLoader();\n\n  try {\n    const data = await fetchImages(currentQuery, currentPage);\n    const hits = data.hits ?? [];\n\n    if (hits.length === 0) {\n      iziToast.info({\n        title: 'Bilgi',\n        message: \"You have reached the end of the search results.\",\n        position: 'topRight',\n      });\n      loadMoreBtn.classList.add('is-hidden');\n      return;\n    }\n\n    const markup = hits.map(createCardMarkup).join('');\n    galleryEl.insertAdjacentHTML('beforeend', markup);\n    lightbox.refresh();\n\n    if (data.totalHits <= currentPage * 40) {\n      loadMoreBtn.classList.add('is-hidden');\n    }\n\n    window.scrollBy(0, galleryEl.querySelector('li').getBoundingClientRect().height * 2); // Scroll down after loading more\n  } catch (error) {\n    console.error(error);\n    iziToast.error({\n      title: 'Hata',\n      message: 'An error occurred while loading more images.',\n      position: 'topRight',\n    });\n  } finally {\n    hideLoader();\n  }\n});\n"],"names":["input","galleryEl","loaderEl","loadMoreBtn","currentPage","currentQuery","lightbox","SimpleLightbox","showLoader","hideLoader","clearGallery","createCardMarkup","image","escapeHtml","str","s","fetchImages","query","page","params","axios","form","evt","data","hits","iziToast","markup","error"],"mappings":"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"}